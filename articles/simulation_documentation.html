<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Darwinian Process - simulation methods • hydramse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Darwinian Process - simulation methods">
<meta property="og:description" content="hydramse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hydramse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/darwinData_explained.html">Lazy Data from Darwinian study</a>
    </li>
    <li>
      <a href="../articles/package_usage.html">How to use hydramse</a>
    </li>
    <li>
      <a href="../articles/simulation_documentation.html">Darwinian Process - simulation methods</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="simulation_documentation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Darwinian Process - simulation methods</h1>
            
      
      
      <div class="hidden name"><code>simulation_documentation.Rmd</code></div>

    </div>

    
    
<hr>
<p>There are several components of the Hydra model that could be considered poorly understood. We need a framework set up to investigate the sensitivity of output to these components. This document outlines the components of the model that are considered most important and provides information regarding how they are being studied</p>
<div id="stock-recruitment" class="section level2">
<h2 class="hasAnchor">
<a href="#stock-recruitment" class="anchor"></a>Stock recruitment</h2>
<p>Many different functional forms for stock recruitment relationships were fit to data (eg. Shepherd, Segmented linear) using maximum likelihood estimation assuming a log normal distribution. The data are output from multispecies VPA models or from single species assessments (when multispecies data are not available). The resulting fits are considered “starting points” for the study. We simulate alternative parameterizations of these relationships based on several rules.</p>
<ol style="list-style-type: decimal">
<li>Each species in the model is classified, based on life history traits, as either having a stock recruitment relationship that displays overcompensation at high stock values or not.</li>
<li>Each species classified as having an overcompensatory stock recruitment function is then assigned, at random, either a Ricker “type” (Shepherd SR function with shape parameter = 2) stock recruitment function or a segmented linear (displaying overcompensation) stock recruitment function.</li>
<li>Each species classified as having a compensatory stock recruitment function is assigned, at random, either a Beverton-Holt (Shepherd SR function with shape parameter = 1) or hockey stick stock-recruitment function.</li>
<li>Alternative parameterization for these chosen functions are then simulated.</li>
</ol>
<p>Species in the model defined as displaying overcompensation are Spiny Dogfish, Winter skate, Cod, Goosefish, silver Hake</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinData.html">darwinData</a></span><span class="op">$</span><span class="va">hockey</span><span class="op">$</span><span class="va">species</span></code></pre></div>
<pre><code>##  [1] "Dogfish"         "Winter_Skate"    "Herring"         "Cod"            
##  [5] "Haddock"         "Yellowtail"      "Winter_Flounder" "Mackerel"       
##  [9] "silver_Hake"     "Monkfish"</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">SRType</span></code></pre></div>
<pre><code>##  [1] 2 2 1 2 1 1 1 1 2 2</code></pre>
<div id="shepherd-recruitment-model" class="section level3">
<h3 class="hasAnchor">
<a href="#shepherd-recruitment-model" class="anchor"></a>Shepherd recruitment model</h3>
<p>We use the Shepherd stock-recruitment function to represent Beverton Holt and ricker type models. Note that subscripts relating to time have been omitted for clarity.</p>
<p><span class="math display">\[R = \frac{\alpha S}{ (1+(\frac{S}{\beta})^\gamma)}\]</span> wherer <span class="math inline">\(\alpha\)</span> has dimensions of recruitment per unit spawner abundance and <span class="math inline">\(\beta\)</span> controls the level of density dependence. <span class="math inline">\(\gamma\)</span> is the shape parameters providing flexibility and generality in the shape of the function</p>
<p>For <span class="math inline">\(\gamma\)</span> = 1 the Shepherd model reduces to the Beverton holt and with <span class="math inline">\(\gamma\)</span> = 2 it approximates the Ricker form</p>
<p>We simulate alternative parameterizations (<span class="math inline">\(\alpha_n\)</span>,<span class="math inline">\(\beta_n\)</span>) of this model by randomly simulating new values of the fitted values <span class="math inline">\(\hat\alpha\)</span> and <span class="math inline">\(\hat\beta\)</span> that satisfly the following conditions:</p>
<p>For the Beverton Holt model (<span class="math inline">\(\gamma = 1\)</span>)</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\alpha_n\)</span> is chosen to be in the interval [<span class="math inline">\(c_1\hat\alpha\)</span>, <span class="math inline">\(c_2\hat\alpha\)</span>]</li>
<li>
<span class="math inline">\(\beta_n\)</span> is chosen to satisfy that the asymptote remains the same as the for the fitted model, <span class="math inline">\(\alpha_n\beta_n = \hat\alpha\hat\beta\)</span>
</li>
</ol>
<p>For the Ricker Type model (<span class="math inline">\(\gamma = 2\)</span>)</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\alpha_n\)</span> is chosen to be in the interval [<span class="math inline">\(c_1\hat\alpha\)</span>, <span class="math inline">\(c_2\hat\alpha\)</span>]</li>
<li>
<span class="math inline">\(\beta_n\)</span> is chosen to ensure the new model reaches the same peak in recruitment (but at a different level of spawning stock biomass). <span class="math inline">\(\beta_n\)</span> is chosen to satisfy <span class="math inline">\(\alpha_n\beta_n = \hat\alpha\hat\beta\)</span>
</li>
</ol>
<p><span class="math inline">\(c_1\)</span> and <span class="math inline">\(c_2\)</span> are constants selected by the user to reflect the with of the interval. Current Values of <span class="math inline">\([c_1,c_2]\)</span> are:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">RickerRangeOfAlphas</span></code></pre></div>
<pre><code>## [1] 0.2 5.0</code></pre>
<p>for both Beverton Holt and Ricker Type models</p>
<div id="proof" class="section level4">
<h4 class="hasAnchor">
<a href="#proof" class="anchor"></a>Proof</h4>
<p>To find maximum of curve (or asymptote): Proof of theory</p>
<p>First find derivative</p>
<p><span class="math display">\[\frac{d R}{d S} = U\frac{d V}{d S} + V\frac{d U}{d S}\]</span> where <span class="math inline">\(U = \alpha S\)</span> and <span class="math inline">\(V= \left(1+(\frac{S}{\beta})^\gamma\right)^{-1}\)</span></p>
<p>So <span class="math display">\[\frac{d R}{d S} = -\alpha \gamma S S^{\gamma -1 } \frac{1}{\beta^{\gamma}}   \left(1+(\frac{S}{\beta})^\gamma\right)^{-2} + \alpha\left(1+(\frac{S}{\beta})^\gamma\right)^{-1}\]</span></p>
<p><span class="math display">\[\frac{d R}{d S} = \left[-\alpha \gamma  (\frac{S}{\beta})^\gamma + \alpha\left(1+(\frac{S}{\beta})^\gamma\right)\right] \left(1+(\frac{S}{\beta})^\gamma\right)^{-2} \]</span></p>
<p>For a maximum <span class="math inline">\(\frac{d R}{d S} =0\)</span>, therfore</p>
<p><span class="math display">\[-\alpha \gamma  (\frac{S}{\beta})^\gamma + \alpha\left(1+(\frac{S}{\beta})^\gamma\right) = 0\]</span> which can be rearranged</p>
<p><span class="math display">\[ \alpha  = \alpha  \left(\frac{S}{\beta}\right)^\gamma (\gamma - 1)\]</span> Which implies</p>
<p><span class="math display">\[  \left(\frac{S}{\beta}\right)^\gamma (\gamma - 1) = 1\]</span> and therfore the value of SSB, <span class="math inline">\(S_p\)</span>, at which maximum recruitment occurs is</p>
<p><span class="math display">\[  S_p = \beta (\gamma - 1)^\frac{-1}{\gamma}\]</span> and the corresponding value of recruitment is</p>
<p><span class="math display">\[  R_p = \frac{\alpha\beta}{\gamma}(\gamma -1)^{\frac{\gamma-1}{\gamma}}\]</span> Since simulated stock recruitment curves are constrained to have the same level of recruitment <span class="math inline">\(R_{p}\)</span> then <span class="math inline">\(\alpha_n\beta_n = \hat\alpha\hat\beta\)</span></p>
</div>
</div>
<div id="segmented-linear-recruitment-model" class="section level3">
<h3 class="hasAnchor">
<a href="#segmented-linear-recruitment-model" class="anchor"></a>Segmented linear recruitment Model</h3>
<p>As an alternative to the traditional stock recruitment functions we use a segmented linear model. Again the subscripts relating to time have been omitted.</p>
<p><span class="math display">\[ \begin{aligned}
R &amp;= \alpha S &amp;&amp; if \;S &lt;= \delta\\
&amp;= \alpha S + \beta(S - \delta)  &amp;&amp; if \;\; S &gt; \delta
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the slope at origin (recruits/biomass), an estimate of density dependent survival. <span class="math inline">\(\delta\)</span> is the change-point, the value of spawning stock in which the slope, <span class="math inline">\(\alpha\)</span>, changes. <span class="math inline">\(\beta\)</span> is the change in slope at the change-point. When <span class="math inline">\(\beta = - \alpha\)</span>, this simplifies to the hockey stick model and resembles a simple piecewise linear alternative to the Beverton Holt model. When <span class="math inline">\(\beta &lt; - \alpha\)</span>, the slope declines after the change-point resembling a simple piecewise linear alternative to the Ricker model.</p>
<p>We simulate alternative parameterizations (<span class="math inline">\(\alpha_n\)</span>,<span class="math inline">\(\beta_n\)</span>,<span class="math inline">\(\delta_n\)</span>) of this model by randomly simulating new values of the fitted values <span class="math inline">\(\hat\alpha\)</span>, <span class="math inline">\(\hat\beta\)</span> and <span class="math inline">\(\hat\delta\)</span>that satisfly the following conditions:</p>
<p>For Hockey stick model</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\delta_{n}\)</span> is drawn from a uniform distribution in the interval <span class="math inline">\([k_1SS_{min},k_2\hat\delta]\)</span> where <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span> are constants supplied by the user to reflect the width of the interval. <span class="math inline">\(SS_{min}\)</span> is the minimum observed spawning stock biomass for the given species. These Spawning stock biomass values are used in the original fitting of all models. <span class="math inline">\(\hat\delta\)</span> is the estimated value of the breakpoint when fitting the stock recruitment function to data</li>
<li>
<span class="math inline">\(\alpha_{n} = \hat\alpha\hat\delta / \delta_{n}\)</span>. We assume that the value of Recruitment at which the breakpoint occurs remains the same. i.e. <span class="math inline">\(\alpha_n \delta_n = \hat\alpha \hat\delta\)</span>
</li>
<li><span class="math inline">\(\beta_{n} = - \alpha_{n}\)</span></li>
</ol>
<p>For the generalized overcompensatory form</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\delta_{n}\)</span> is drawn from a uniform distribution in the interval <span class="math inline">\([k_1 SS_{min},k_2\hat\delta]\)</span>
</li>
<li><span class="math inline">\(\alpha_{n} = \hat\alpha\hat\delta / \delta_{n}\)</span></li>
<li>
<span class="math inline">\(\beta_{n}\)</span> is chosen such that the resulting model passes through the same point at the maximum observed spawning stock biomass as the fitted model. This point is <span class="math inline">\([SS_{max},\hat{SS_{max}}]\)</span> and the slope from the new simulated point <span class="math inline">\([\delta_n, \alpha_n \delta_n\)</span> is <span class="math display">\[ slope = \frac{\hat{SS_{max}}-\alpha_n \delta_n}{SS_{max}-\delta_n}\]</span>
</li>
</ol>
<p>The one caveat is that it possible for fitted models to have an increasing slope following the breakpoint (<span class="math inline">\(\hat\beta &gt; -\hat\alpha\)</span>) implying non compensatory effects. If this arises we take the mirror image of the fit (using <span class="math inline">\(\hat\beta\)</span> = <span class="math inline">\(-\hat\alpha\)</span> as the mirror) and proceed as described above.</p>
<p>Current Values of <span class="math inline">\([k_1,k_2]\)</span> are :</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">rangeOfBreakpoint</span></code></pre></div>
<pre><code>## [1] 0.5 1.5</code></pre>
<p>Note: Add figure showing segmented linear options</p>
</div>
</div>
<div id="other-food" class="section level2">
<h2 class="hasAnchor">
<a href="#other-food" class="anchor"></a>Other food</h2>
<p>Other food in the model is assumed to to take one of the following values:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">otherFood</span></code></pre></div>
<pre><code>##  [1] 10000 15000 20000 25000 30000 35000 40000 45000 50000 55000 60000</code></pre>
<p>and is selected at random.</p>
</div>
<div id="criteria-to-accept-simulated-parameter-values" class="section level2">
<h2 class="hasAnchor">
<a href="#criteria-to-accept-simulated-parameter-values" class="anchor"></a>Criteria to accept simulated parameter values</h2>
<p>The multispecies model, Hydra, is then run (in the absence of stock recruitment error) with each set of simulated parameter values. The model in run for 97 years in the absence of fishing pressure to ensure all species can coexist. From the resulting state of the system, the model is run a further 53 under historic fishing pressure.</p>
<p>The output is then analysed to determin if these parameter values result in a multispecies fishery that reflect historically observed biomass and catch data</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">biomassRule</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">catchRule</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>These checks can be turned off by the user. Default = “on”</p>
<div id="biomass-evaluation" class="section level3">
<h3 class="hasAnchor">
<a href="#biomass-evaluation" class="anchor"></a>Biomass evaluation</h3>
<p>The biomass of each species is examined at two time periods.</p>
<p>Immediately preceeding the period of fishing. The average biomass is calculated over the last n years of the simulation during the period of no fishing. The average biomass, for all species, over this time period must exceed lower limits. These limits are defined, for each species, as the lowest observed spawning stock biomass from the spring and fall trawl surveys (since they began in 1968).</p>
<p>The average biomass for each species is again calculated toward the end of the simulation. These values must also lie within limits. These limits are defined as a <span class="math inline">\([b_1 min(SS_{survey}),b_2 max(SS_{survey})]\)</span> where the constants <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are selected by the user.</p>
<p>Current Values of <span class="math inline">\([b_1,b_2]\)</span> are:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">biomassBounds</span></code></pre></div>
<pre><code>## [1] 0.5 2.0</code></pre>
<p>The number of years used to calculate the average biomass is an option for the user. Currently this is set to:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">lastNPoints</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>If both criteria are satisfied for all species then catch is assessed.</p>
</div>
<div id="catch-evaluation" class="section level3">
<h3 class="hasAnchor">
<a href="#catch-evaluation" class="anchor"></a>Catch evaluation</h3>
<p>Catch is assessed in the same way as biomass. The average catch at the end of the simulation must lie within limits defined as <span class="math inline">\([c_1 min(Landings),c_2 max(Landings)]\)</span>. Again the constants <span class="math inline">\(c_1\)</span> and <span class="math inline">\(c_2\)</span> are options for the user. Current they are:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">hydramse</span><span class="fu">::</span><span class="va"><a href="../reference/darwinRules.html">darwinRules</a></span><span class="op">$</span><span class="va">catchBounds</span></code></pre></div>
<pre><code>## [1] 1 1</code></pre>
<p>If all three of these criteria are satisfied the parameter set simulated is considered acceptable and a full set of scenario runs can be made</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andy Beet.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
